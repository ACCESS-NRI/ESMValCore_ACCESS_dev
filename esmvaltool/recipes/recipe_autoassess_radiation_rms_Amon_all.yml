#### summary
#recipe_autoassess_radiation_rms_Amon_all.yml
#
#Description
#Diagnostics of spatial RMS errors of radiation and clouds
#
#Author
#Yoko Tsushima (Met Office, United Kingdom - yoko.tsushima@metoffice.gov.uk)
#
#Contributor
#Simon Read (University of Reading,  United Kingdom)
#
#Author version2
#Valeriu Predoi: VP (University of Reading, UK)
#
#Project
#CMUG
#
#Port to ESMValTool v2: July 2018
# Final version of recipe: 18 July 2018
#
#References
#Technical report or a paper will be written in the future.
#
#This recipe is part of the ESMValTool
#
#Caveats:
# - uncomment out OBS files; VP has no access to such files so testing was done with
#   MPI-ESM-MR as 'OBS' dataset; various fixes will have to be implemented for these
#   files; fully working in this version though.
###########################################################################################################
---

datasets:
  - {dataset: MPI-ESM-LR,  project: CMIP5,  mip: Amon,  exp: historical,  ensemble: r1i1p1,  start_year: 2001,  end_year: 2005}
  - {dataset: NorESM1-M,   project: CMIP5,  mip: Amon,  exp: historical,  ensemble: r1i1p1,  start_year: 2001,  end_year: 2005}

preprocessors:
  pp_rad:
    regrid:
      target_grid: 1x1
      scheme: linear

diagnostics:
  radiation_Amon_all:
    description: 
    variables: # 13 required variables total
      rtnt: # ceres TOA TOT net
        preprocessor: pp_rad
        field: T2Ms
        derive: true
        force_derivation: false
      rsnt: # ceres TOA SW net
        preprocessor: pp_rad
        field: T2Ms
        derive: true
        force_derivation: false
      swcre: # ceres TOA SW Cloud Radiative Effect
        preprocessor: pp_rad
        field: T2Ms
        derive: true
        force_derivation: false
      lwcre: # ceres TOA LW Cloud Radiative Effect
        preprocessor: pp_rad
        field: T2Ms
        derive: true
        force_derivation: false
      rsns: # ceres Surf SW net all sky
        preprocessor: pp_rad
        field: T2Ms
        derive: true
        force_derivation: false
      rlns: # ceres Surf LW net all sky
        preprocessor: pp_rad
        field: T2Ms
        derive: true
        force_derivation: false
      rsut: # ceres TOA SW up all sky
        preprocessor: pp_rad
        field: T2Ms
      rlut: # ceres TOA LW up all sky
        preprocessor: pp_rad
        field: T2Ms
      rsutcs: # ceres TOA SW up clear sky
        preprocessor: pp_rad
        field: T2Ms
      rlutcs: # jra TOA LW up clear sky
        preprocessor: pp_rad
        field: T2Ms
      rldscs: # jra Surf LW down clear sky
        preprocessor: pp_rad
        field: T2Ms
      prw: # ssmi Column Water vapour
        preprocessor: pp_rad
        field: T2Ms
      pr: # gpcp Precipitation
        preprocessor: pp_rad
        field: T2Ms
    additional_datasets:
      # all OBS; don't have any so using MPI-ESM-MR for testing instead !!!
      # xml entry: obs4mips CERES-EBAF L3B Ed2-7 2001 2012
      # - {dataset: CERES-EBAF,  project: obs4mips,  type: L3B,  version: Ed2-7,  start_year: 2001,  end_year: 2012, tier: Tier1}
      # xml entry: ana4mips   JRA-55 Amon reanalysis   2001  2005 @{OBSPATH}/Tier1/
      # - {dataset: JRA-55,  project: ana4mips,  type: reanaly,  start_year: 2001,  end_year: 2005, tier: Tier1}
      # xml entry: obs4mips SSMI-MERIS L3 v1-00 2003 2008
      # - {dataset: SSMI-MERIS,  project: obs4mips,  type: L3,  version: v1-00,  start_year: 2003,  end_year: 2008, tier: Tier1}
      # xml entry: obs4mips GPCP-SG L3 v2.2 2001 2009
      # - {dataset: GPCP-SG,  project: obs4mips,  type: L3,  version: v2.2,  start_year: 2001,  end_year: 2009, tier: Tier1}
      # for testing only
      - {dataset: MPI-ESM-MR,  project: CMIP5,  mip: Amon,  exp: historical,  ensemble: r1i1p1,  start_year: 2001,  end_year: 2005}
    scripts:
      autoassess_Radiation_rms_Amon_all:
        script: autoassess/autoassess_radiation_rms.py
        title: "Autoassess Radiation RMS Amon All"
        control_model: MPI-ESM-LR
        exper_model: NorESM1-M
        analysis_type: lat_lon  # use any of: lat_lon, zonal_mean, vertical_mean
        landsea_mask: landsea.nc
