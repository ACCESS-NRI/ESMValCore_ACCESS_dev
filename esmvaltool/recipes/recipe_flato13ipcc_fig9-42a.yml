###############################################################################
# recipe_flato13ipcc.yml
---
documentation:
description: |
    Reproducing selected figures from IPCC AR5, chap. 9 (Flato et al., 2013):
    9.42a

authors:
    - schl_ma

references:
    - flato13ipcc

projects:
    - esmval
    - crescendo


preprocessors:

    noop:
        {}


diagnostics:

    fig09-42a:
        description: ECS vs. GMSAT.
        variables:
            tas:
                preprocessor: noop
                mip: Amon
                field: T2Ms
            rtmt:
                preprocessor: noop
                mip: Amon
                field: T2Ms
        additional_datasets:
            # Day is out of range for month (wait for iris > 2.0)
            # - {dataset: ACCESS1-0,     project: CMIP5, exp: historical,  ensemble: r1i1p1, start_year: 1961, end_year: 1990}
            # - {dataset: ACCESS1-0,     project: CMIP5, exp: piControl,   ensemble: r1i1p1, start_year:  300, end_year:  449}
            # - {dataset: ACCESS1-0,     project: CMIP5, exp: abrupt4xCO2, ensemble: r1i1p1, start_year:  300, end_year:  449}
            - {dataset: bcc-csm1-1,    project: CMIP5, exp: historical,  ensemble: r1i1p1, start_year: 1961, end_year: 1990}
            - {dataset: bcc-csm1-1,    project: CMIP5, exp: piControl,   ensemble: r1i1p1, start_year:  160, end_year:  309}
            - {dataset: bcc-csm1-1,    project: CMIP5, exp: abrupt4xCO2, ensemble: r1i1p1, start_year:  160, end_year:  309}
            - {dataset: bcc-csm1-1-m,  project: CMIP5, exp: historical,  ensemble: r1i1p1, start_year: 1961, end_year: 1990}
            - {dataset: bcc-csm1-1-m,  project: CMIP5, exp: piControl,   ensemble: r1i1p1, start_year:  240, end_year:  389}
            - {dataset: bcc-csm1-1-m,  project: CMIP5, exp: abrupt4xCO2, ensemble: r1i1p1, start_year:  240, end_year:  389}
            - {dataset: CanESM2,       project: CMIP5, exp: historical,  ensemble: r1i1p1, start_year: 1961, end_year: 1990}
            - {dataset: CanESM2,       project: CMIP5, exp: piControl,   ensemble: r1i1p1, start_year: 2015, end_year: 2164}
            - {dataset: CanESM2,       project: CMIP5, exp: abrupt4xCO2, ensemble: r1i1p1, start_year: 1850, end_year: 1999}
            - {dataset: CCSM4,         project: CMIP5, exp: historical,  ensemble: r1i1p1, start_year: 1961, end_year: 1990}
            - {dataset: CCSM4,         project: CMIP5, exp: piControl,   ensemble: r1i1p1, start_year:  800, end_year:  949}
            - {dataset: CCSM4,         project: CMIP5, exp: abrupt4xCO2, ensemble: r1i1p1, start_year: 1850, end_year: 1999}
            - {dataset: CNRM-CM5,      project: CMIP5, exp: historical,  ensemble: r1i1p1, start_year: 1961, end_year: 1990}
            - {dataset: CNRM-CM5,      project: CMIP5, exp: piControl,   ensemble: r1i1p1, start_year: 1850, end_year: 1999}
            - {dataset: CNRM-CM5,      project: CMIP5, exp: abrupt4xCO2, ensemble: r1i1p1, start_year: 1850, end_year: 1999}
            - {dataset: CSIRO-Mk3-6-0, project: CMIP5, exp: historical,  ensemble: r1i1p1, start_year: 1961, end_year: 1990}
            - {dataset: CSIRO-Mk3-6-0, project: CMIP5, exp: piControl,   ensemble: r1i1p1, start_year:    1, end_year:  150}
            - {dataset: CSIRO-Mk3-6-0, project: CMIP5, exp: abrupt4xCO2, ensemble: r1i1p1, start_year:    1, end_year:  150}
            - {dataset: GFDL-CM3,      project: CMIP5, exp: historical,  ensemble: r1i1p1, start_year: 1961, end_year: 1990}
            - {dataset: GFDL-CM3,      project: CMIP5, exp: piControl,   ensemble: r1i1p1, start_year:    1, end_year:  150}
            - {dataset: GFDL-CM3,      project: CMIP5, exp: abrupt4xCO2, ensemble: r1i1p1, start_year:    1, end_year:  150}
            - {dataset: GISS-E2-H,     project: CMIP5, exp: historical,  ensemble: r1i1p1, start_year: 1961, end_year: 1990}
            - {dataset: GISS-E2-H,     project: CMIP5, exp: piControl,   ensemble: r1i1p1, start_year: 1200, end_year: 1349}
            - {dataset: GISS-E2-H,     project: CMIP5, exp: abrupt4xCO2, ensemble: r1i1p1, start_year: 1850, end_year: 1999}
            - {dataset: GISS-E2-R,     project: CMIP5, exp: historical,  ensemble: r1i1p1, start_year: 1961, end_year: 1990}
            - {dataset: GISS-E2-R,     project: CMIP5, exp: piControl,   ensemble: r1i1p1, start_year: 3331, end_year: 3480}
            - {dataset: GISS-E2-R,     project: CMIP5, exp: abrupt4xCO2, ensemble: r1i1p1, start_year: 1850, end_year: 1999}
            - {dataset: inmcm4,        project: CMIP5, exp: historical,  ensemble: r1i1p1, start_year: 1961, end_year: 1990}
            - {dataset: inmcm4,        project: CMIP5, exp: piControl,   ensemble: r1i1p1, start_year: 2090, end_year: 2239}
            - {dataset: inmcm4,        project: CMIP5, exp: abrupt4xCO2, ensemble: r1i1p1, start_year: 2090, end_year: 2239}
            - {dataset: IPSL-CM5A-LR,  project: CMIP5, exp: historical,  ensemble: r1i1p1, start_year: 1961, end_year: 1990}
            - {dataset: IPSL-CM5A-LR,  project: CMIP5, exp: piControl,   ensemble: r1i1p1, start_year: 1850, end_year: 1999}
            - {dataset: IPSL-CM5A-LR,  project: CMIP5, exp: abrupt4xCO2, ensemble: r1i1p1, start_year: 1850, end_year: 1999}
            - {dataset: IPSL-CM5B-LR,  project: CMIP5, exp: historical,  ensemble: r1i1p1, start_year: 1961, end_year: 1990}
            - {dataset: IPSL-CM5B-LR,  project: CMIP5, exp: piControl,   ensemble: r1i1p1, start_year: 1850, end_year: 1999}
            - {dataset: IPSL-CM5B-LR,  project: CMIP5, exp: abrupt4xCO2, ensemble: r1i1p1, start_year: 1850, end_year: 1999}
            # Because of issues in the date format, these models raise an
            # AttributeError: 'NoneType' object has no attribute 'units'
            # Can be solved by removing lines 104-106 of ESMValTool/esmvaltool/cmor/_fixes/CMIP5/MIROC_ESM.py,
            # but leads to failing tests
            # - {dataset: MIROC-ESM,     project: CMIP5, exp: historical,  ensemble: r1i1p1, start_year: 1961, end_year: 1990}
            # - {dataset: MIROC-ESM,     project: CMIP5, exp: piControl,   ensemble: r1i1p1, start_year: 1800, end_year: 1949}
            # - {dataset: MIROC-ESM,     project: CMIP5, exp: abrupt4xCO2, ensemble: r1i1p1, start_year:    1, end_year:  150}
            - {dataset: MIROC5,        project: CMIP5, exp: historical,  ensemble: r1i1p1, start_year: 1961, end_year: 1990}
            - {dataset: MIROC5,        project: CMIP5, exp: piControl,   ensemble: r1i1p1, start_year: 2100, end_year: 2249}
            - {dataset: MIROC5,        project: CMIP5, exp: abrupt4xCO2, ensemble: r1i1p1, start_year: 2100, end_year: 2249}
            - {dataset: MPI-ESM-LR,    project: CMIP5, exp: historical,  ensemble: r1i1p1, start_year: 1961, end_year: 1990}
            - {dataset: MPI-ESM-LR,    project: CMIP5, exp: piControl,   ensemble: r1i1p1, start_year: 2015, end_year: 2164}
            - {dataset: MPI-ESM-LR,    project: CMIP5, exp: abrupt4xCO2, ensemble: r1i1p1, start_year: 1850, end_year: 1999}

        scripts:
            fig09-42a:
                script: ipcc_ar5/ch09_fig09_42a.py
                plot_ecs_regression: True
