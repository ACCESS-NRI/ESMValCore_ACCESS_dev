--- !Namelist
###############################################################################
# namelist_perfmetrics_CMIP5.xml
#
# Description
# Namelist for plotting the performance metrics for the CMIP5 models. It
# considers temperature, zonal and meridional wind, geopotential height,
# surface temperature, precipitation, TOA SW and LW radiation, SW and LW cloud
# radiative effects, and aerosol optical depth
#
# Authors
# Franziska Frank (DLR, Germany)
# Mattia Righi (DLR, Germany)
# Veronika Eyring (DLR, Germany)
#
# Project
# DLR ESMVal
#
# Reference
# Gleckler et al., J. Geophys. Res., 113, D06104, doi: 10.1029/2007JD008972
# (2008)
#
# This namelist is part of the ESMValTool
###############################################################################

GLOBAL:
  write_plots:       True
  write_netcdf:      True
#    force_processing:  False # this goes away
#    wrk_dir:           ./work/    # this goes to config file
#    plot_dir:          ./plots/   # this goes to config file
#    preproc_dir:       ./preproc/ # this goes to config file
  verbosity:         1
  exit_on_warning:   False
  output_file_type:  ps
#    max_data_filesize:   100 # not needed
#    max_data_blocksize:  500 # not needed
#    force_calc:        False # not needed?
#    force_gradecalc:   False # not needed?
#    force_taylorcalc:  False # not needed?

MODELS:
  - {name: bcc-csm1-1, project: CMIP5_ETHZ,  mip: Amon,  exp: historical,  ensemble: r1i1p1,  start: 2000,  end: 2002,  path: /modelpath/}
  - {name: CMCC-CESM,  project: CMIP5_ETHZ,  mip: Amon,  exp: historical,  ensemble: r1i1p1,  start: 2000,  end: 2002,  path: /modelpath/}

PREPROCESS:
    - {id: pp1, select_level: None, target_grid: ref_model, regrid_scheme: linear, mask_fillvalues: True, mask_landocean: None, multimodel_mean: True}
    - {id: pp2, select_level: 850, target_grid: ref_model, regrid_scheme: linear, mask_fillvalues: True, mask_landocean: None, multimodel_mean: True}
    - {id: pp3, select_level: 200, target_grid: ref_model, regrid_scheme: linear, mask_fillvalues: True, mask_landocean: None, multimodel_mean: True}


DIAGNOSTICS:

    # temperature annual cycle at 850 hPa
    !Diagnostic
        id: DIAG_ta850
        tags: [R_aerosol, R_atmos ]
        variables: 
            - {name: ua, ref_model: ["ERA-Interim", "NCEP"], field: T3M, preproc:  pp1}
            - {name: ua, ref_model: ["ERA-Interim", "NCEP"], field: T3M, preproc:  pp3}
            - {name: pr, ref_model: ["ERA-Interim", "NCEP"], field: T3M, preproc:  pp2}
        scripts:
          - {script: perfmetrics_main.ncl,     cfg_file: ./nml/cfg_perfmetrics/CMIP5/cfg_perfmetrics_cycle_monthlyclim_850_glob.ncl}
          - {script: perfmetrics_grading.ncl,  cfg_file: ./nml/cfg_perfmetrics/CMIP5/cfg_perfmetrics_grading_RMSD_850_glob.ncl}
          - {script: perfmetrics_taylor.ncl,   cfg_file: ./nml/cfg_perfmetrics/CMIP5/cfg_perfmetrics_taylor_RMSD_850_glob.ncl}
        additional_models:
          - {name: GFDL-ESM2G, project: CMIP5_ETHZ,  mip: Amon,  exp: historical,  ensemble: r1i1p1,  start: 2000,  end: 2002,  path: /modelpath/}
          - {name: ERA-Interim,  project: OBS,  type: reanaly,  version: 1,  start: 2000,  end: 2002,  path: /obspath/Tier3/ERA-Interim/}
          - {name: NCEP,         project: OBS,  type: reanaly,  version: 1,  start: 2000,  end: 2002,  path: /obspath/Tier2/NCEP/}

    # temperature annual cycle at 200 hPa
    !Diagnostic
        id: DIAG_ta200
        variables: 
          - {name: ta, ref_model: ["ERA-Interim", "NCEP"], field: T3M, preproc_setting:  XYZ}
        preprocess:
          select_level: 200
        scripts:
          - {script: perfmetrics_main.ncl,     cfg_file: ./nml/cfg_perfmetrics/CMIP5/cfg_perfmetrics_cycle_monthlyclim_200_glob.ncl}
          - {script: perfmetrics_grading.ncl,  cfg_file: ./nml/cfg_perfmetrics/CMIP5/cfg_perfmetrics_grading_RMSD_200_glob.ncl}
          - {script: perfmetrics_taylor.ncl,   cfg_file: ./nml/cfg_perfmetrics/CMIP5/cfg_perfmetrics_taylor_RMSD_200_glob.ncl}
        additional_models:
          - {name: GFDL-ESM2G, project: CMIP5_ETHZ,  mip: Amon,  exp: historical,  ensemble: r1i1p1,  start: 2000,  end: 2002,  path: /modelpath/}
          - {name: ERA-Interim,  project: OBS,  type: reanaly,  version: 1,  start: 2000,  end: 2002,  path: /obspath/Tier3/ERA-Interim/}
          - {name: NCEP,         project: OBS,  type: reanaly,  version: 1,  start: 2000,  end: 2002,  path: /obspath/Tier2/NCEP/}
    

    # temperature zonal mean
    !Diagnostic
        id: DIAG_taZONAL
        variable: {name: ta, ref_model: ["ERA-Interim", "NCEP"], field: T3M}
        scripts:
          - {script: perfmetrics_main.ncl,     cfg_file: ./nml/cfg_perfmetrics/CMIP5/cfg_perfmetrics_zonal_annualclim_all_glob.ncl}
        additional_models:
          - {name: GFDL-ESM2G, project: CMIP5_ETHZ,  mip: Amon,  exp: historical,  ensemble: r1i1p1,  start: 2000,  end: 2002,  path: /modelpath/}
          - {name: ERA-Interim,  project: OBS,  type: reanaly,  version: 1,  start: 2000,  end: 2002,  path: /obspath/Tier3/ERA-Interim/}
          - {name: NCEP,         project: OBS,  type: reanaly,  version: 1,  start: 2000,  end: 2002,  path: /obspath/Tier2/NCEP/}
    
    # This diag does not require variables nor models
    # collect and plot previously calculated gradings
    !Diagnostic
        id: DIAG_GRADING
        requires: [DIAG_ta850, DIAG_ta200, DIAG_taZONAL]
        scripts:
          - {script: perfmetrics_grading_collect.ncl,     cfg_file: ./nml/cfg_perfmetrics/CMIP5/cfg_perfmetrics_grading_collect.ncl}
    
    # This diag does not require variables nor models
    # collect and plot previously calculated Taylor metrics
    !Diagnostic
        id: DIAG_TAYLOR
        requires: [DIAG_ta850, DIAG_ta200, DIAG_taZONAL]
        scripts:
          - {script: perfmetrics_taylor_collect.ncl,     cfg_file: ./nml/cfg_perfmetrics/CMIP5/cfg_perfmetrics_taylor_collect.ncl}
